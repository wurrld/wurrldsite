<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>wurrld.</title>

<link rel="stylesheet" href="home.css?v=1.6">

<link rel="icon" type="image/x-icon" href="favicon.iso">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="192x192" href="android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="android-chrome-512x512.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#ff0000">
<meta name="theme-color" content="#ff0000">
</head>
<body>
<div class="container">
    <h1>wurrld.</h1>
</div>

<div class="square-wrapper" id="s1">
    <div class="square"></div>
    <p>WIP</p>
</div>
<div class="square-wrapper" id="s2">
    <div class="square"></div>
    <p>WIP</p>
</div>
<div class="square-wrapper" id="s3">
    <div class="square"></div>
    <p>WIP</p>
</div>
<div class="square-wrapper" id="s4">
    <div class="square"></div>
    <p>WIP</p>
</div>

<script>
const squares = document.querySelectorAll('.square-wrapper');
const heading = document.querySelector('h1');
const container = document.querySelector('.container');

function isOverlap(r1, r2) {
    return !(r1.left > r2.right || r1.right < r2.left || r1.top > r2.bottom || r1.bottom < r2.top);
}

function setContainerHeight() {
    if (window.matchMedia("(max-width:600px)").matches && window.matchMedia("(orientation: portrait)").matches) {
        container.style.height = `${window.innerHeight * 0.92}px`;
    } else {
        container.style.height = `${window.innerHeight}px`;
    }
}

function placeSquares() {
    const vw = window.innerWidth;
    const vh = container.clientHeight;

    setContainerHeight();

    heading.style.transform = "translateY(-12%)";

    const hRect = heading.getBoundingClientRect();
    const headingZone = {
        top: hRect.top - 10,
        bottom: hRect.bottom + 10,
        left: hRect.left - 10,
        right: hRect.right + 10
    };

    const zones = [
        { top: 0, left: 0, width: vw/2, height: vh/2 },
        { top: 0, left: vw/2, width: vw/2, height: vh/2 },
        { top: vh/2, left: 0, width: vw/2, height: vh/2 },
        { top: vh/2, left: vw/2, width: vw/2, height: vh/2 }
    ];

    const placedRects = [];

    squares.forEach((square, i) => {
        const zone = zones[i];
        let w = square.offsetWidth;
        let h = square.offsetHeight;

        if(window.matchMedia("(max-width:600px) and (orientation: landscape)").matches){
            w *= 0.8;
            h *= 0.8;
            square.style.width = `${w}px`;
            square.style.height = `${h}px`;
        }

        let attempts = 0;
        let pos = {};
        do {
            attempts++;
            pos.top = Math.min(zone.top + Math.random() * (zone.height - h), vh - h);
            pos.left = Math.min(zone.left + Math.random() * (zone.width - w), vw - w);
            const rect = { top: pos.top, left: pos.left, bottom: pos.top + h, right: pos.left + w };
            const collidesHeading = isOverlap(rect, headingZone);
            const collidesSquares = placedRects.some(r => isOverlap(rect, r));
            if (!collidesHeading && !collidesSquares) {
                placedRects.push(rect);
                square.style.top = `${pos.top}px`;
                square.style.left = `${pos.left}px`;
                break;
            }
        } while (attempts < 100);
    });
}

let resizeTimeout;
function recalcLayout() {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(placeSquares, 50);
}

placeSquares();

window.addEventListener('resize', recalcLayout);
window.addEventListener('orientationchange', recalcLayout);
</script>
</body>
</html>
